# Redis ë²„ì „ ê´€ë¦¬ ê°€ì´ë“œ

## âš ï¸ ì¤‘ìš”: Redis íŒ¨í‚¤ì§€ ë²„ì „ ì—…ê·¸ë ˆì´ë“œ ê¸ˆì§€

### í˜„ì¬ ì•ˆì •ì ì¸ êµ¬ì„±

```json
{
  "redis": "^4.6.5",
  "connect-redis": "^6.1.3",
  "ioredis": "^5.6.1"
}
```

## ğŸš« Redis v5 ì—…ê·¸ë ˆì´ë“œë¥¼ í•˜ë©´ ì•ˆ ë˜ëŠ” ì´ìœ 

### 1. í˜¸í™˜ì„± ë¬¸ì œ
- **connect-redis v6.1.3**ëŠ” `redis` v3~v4ë§Œ ì§€ì›
- **connect-redis v7**ì€ `redis` v4ë¥¼ ì§€ì›í•˜ì§€ë§Œ, v5ëŠ” ë¯¸ì§€ì›
- Redis v5ë¡œ ì—…ê·¸ë ˆì´ë“œ ì‹œ ì„¸ì…˜ ì €ì¥ ê¸°ëŠ¥ì´ ì™„ì „íˆ ì¤‘ë‹¨ë¨

### 2. íˆìŠ¤í† ë¦¬
```bash
# ê³¼ê±° ì‹œë„ ê¸°ë¡
9520d15 - Revert "Merge pull request #174 (redis v5.8.3ë¡œ ì—…ê·¸ë ˆì´ë“œ ì‹œë„)"
40d866e - Revert "fix :: êµ¬ë²„ì „ Redis ì œê±°"
```

ì´ë¯¸ Redis v5ë¡œ ì—…ê·¸ë ˆì´ë“œë¥¼ ì‹œë„í–ˆë‹¤ê°€ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ë¡¤ë°±í•œ ì´ë ¥ì´ ìˆìŠµë‹ˆë‹¤.

### 3. ê¸°ìˆ ì  ì´ìŠˆ
- `legacyMode: true` ì˜µì…˜ì´ í•„ìˆ˜ì¸ë°, Redis v5ì—ì„œëŠ” ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠìŒ
- ì„¸ì…˜ ë¯¸ë“¤ì›¨ì–´ ì´ˆê¸°í™” ì‹œ íƒ€ì… ì—ëŸ¬ ë°œìƒ
- Rate limiting ê¸°ëŠ¥ ì¥ì• 

## âœ… ì•ˆì „í•œ ì—…ê·¸ë ˆì´ë“œ ê²½ë¡œ

### ì˜µì…˜ 1: í˜„ì¬ êµ¬ì„± ìœ ì§€ (ê¶Œì¥)
```json
{
  "redis": "^4.6.5",
  "connect-redis": "^6.1.3"
}
```

**ì¥ì :**
- ì•ˆì •ì ìœ¼ë¡œ ê²€ì¦ëœ êµ¬ì„±
- ì„¸ì…˜, Rate Limiting, ìºì‹± ëª¨ë‘ ì •ìƒ ë™ì‘
- ìë™ ì¬ì—°ê²° ë° ì—ëŸ¬ ì²˜ë¦¬ êµ¬í˜„ ì™„ë£Œ

### ì˜µì…˜ 2: ioredisë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜
`ioredis`ëŠ” ì´ë¯¸ v5.6.1ì´ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë©°, ë” ìµœì‹  Redis ì„œë²„ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

**í•„ìš”í•œ ì‘ì—…:**
1. `src/config/redis/redisClient.ts` ì „ì²´ ì¬ì‘ì„±
2. `connect-redis` ì„¤ì • ë³€ê²½ (ioredis í˜¸í™˜ ëª¨ë“œ)
3. ëª¨ë“  Redis ì‚¬ìš©ì²˜ í…ŒìŠ¤íŠ¸
4. Rate limiting, caching ë¡œì§ ì¬ê²€ì¦

**ì˜ˆìƒ ì‘ì—… ì‹œê°„:** 4-6ì‹œê°„

## ğŸ›¡ï¸ í˜„ì¬ êµ¬í˜„ëœ ì•ˆì •í™” ê¸°ëŠ¥

### 1. ì¤‘ì•™ ì§‘ì¤‘ì‹ Redis í´ë¼ì´ì–¸íŠ¸
- íŒŒì¼: `src/config/redis/redisClient.ts`
- ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ 3ê°œ ì¤‘ë³µ í´ë¼ì´ì–¸íŠ¸ í†µí•©

### 2. ìë™ ì¬ì—°ê²°
```typescript
reconnectStrategy: (retries: number) => {
  const delay = Math.min(retries * 100, 10000);
  return delay; // ìµœëŒ€ 10ì´ˆê¹Œì§€ ì ì§„ì  ì¬ì‹œë„
}
```

### 3. Redis ì—†ì´ë„ ì„œë²„ ë™ì‘ (Graceful Degradation)
- ì„¸ì…˜: ë©”ëª¨ë¦¬ ê¸°ë°˜ìœ¼ë¡œ ìë™ ì „í™˜
- Rate Limiting: ë©”ëª¨ë¦¬ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘
- ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´ degraded modeë¡œ ê³„ì† ìš´ì˜

## ğŸ“š ì°¸ê³  ìë£Œ

- [connect-redis v6 ë¬¸ì„œ](https://github.com/tj/connect-redis/tree/v6.1.3)
- [redis npm v4 ë¬¸ì„œ](https://github.com/redis/node-redis/tree/redis%404.6.5)
- í”„ë¡œì íŠ¸ ì»¤ë°‹: `674cba5`, `2c49da2`

## ğŸ”§ ë¬¸ì œ ë°œìƒ ì‹œ

Redis ê´€ë ¨ ë¬¸ì œê°€ ë°œìƒí•˜ë©´:

1. Redis ì„œë²„ ìƒíƒœ í™•ì¸
   ```bash
   redis-cli ping
   ```

2. ë¡œê·¸ í™•ì¸
   ```bash
   # Redis ì—°ê²° ìƒíƒœ í™•ì¸
   grep "Redis" logs/combined-*.log
   ```

3. ì„œë²„ ì¬ì‹œì‘ (Redis ì—†ì´ë„ ë™ì‘)
   ```bash
   npm run dev
   ```

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:** 2025-10-10
**ë‹´ë‹¹ì:** Redis ì¤‘ì•™ ì§‘ì¤‘í™” ë¦¬íŒ©í† ë§ ì™„ë£Œ
**ë¸Œëœì¹˜:** `refactor/redis-centralization`
